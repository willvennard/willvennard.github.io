{"ast":null,"code":"// snake\nlet gameTicker;\nlet playing = false;\nlet count = 0;\nconst segmentDim = 10;\nconst boardWidth = 300;\nconst boardHeight = 300;\nconst segmentRadius = 5;\nlet foodCord = [];\nlet headCord = [];\nlet snakeBody = [];\nlet foodOnBoard = false;\nlet score = 0;\nlet speed = 200;\nlet snakeTail = [];\nlet snakeDirection = 'ArrowRight';\nlet lastSnakeDirection = ''; // bomb stuff\n\nlet bombCord = [];\nlet liveBomb = false;\nlet bombCount = 0;\nlet bombRadius = 2;\nexport function setClickFunction() {\n  d3.select('#start-snake').on('click', function () {\n    console.log('d3 click home, start game'); // if playing\n\n    if (playing) {\n      d3.select('#homeInfo').style('display', 'inline');\n      playing = false;\n    } else {\n      d3.select('#homeInfo').style('display', 'none');\n      d3.select('#snakeGame').style('display', 'inline');\n      initGame();\n      playing = true;\n    }\n  });\n}\nconsole.warn(\"IS this loaded?\", d3.select('#start-snake'));\nsetClickFunction();\ndocument.addEventListener('keydown', event => {\n  if (event.key === 'ArrowLeft' || event.key === 'ArrowUp' || event.key === 'ArrowRight' || event.key === 'ArrowDown') {\n    event.preventDefault();\n\n    if (snakeDirection === 'ArrowLeft' && event.key === 'ArrowRight') {\n      return;\n    }\n\n    if (snakeDirection === 'ArrowRight' && event.key === 'ArrowLeft') {\n      return;\n    }\n\n    if (snakeDirection === 'ArrowUp' && event.key === 'ArrowDown') {\n      return;\n    }\n\n    if (snakeDirection === 'ArrowDown' && event.key === 'ArrowUp') {\n      return;\n    }\n\n    snakeDirection = event.key;\n  }\n});\n\nfunction initGame() {\n  headCord = [0, 0];\n  snakeBody = [];\n  score = 0;\n  speed = 200;\n  bombCount = 0;\n  snakeDirection = 'ArrowRight';\n  snakeBody.push(headCord);\n  d3.select('#gameSpace').append('svg').attr('id', 'board').attr('width', boardWidth).attr('height', boardHeight).append('rect').attr('class', 'snake head').attr(\"id\", \"segment\" + (snakeBody.length - 1)).attr('width', segmentDim).attr('height', segmentDim).attr('x', headCord[0]).attr('y', headCord[1]).attr(\"ry\", segmentRadius).attr(\"rx\", segmentRadius).attr('fill', 'red');\n  document.getElementById('score').innerHTML = score;\n  spawnFood();\n  gameTick();\n}\n\nfunction randomBoardCord() {\n  let x = Math.round(Math.random() * boardWidth / segmentDim) * segmentDim - segmentDim;\n  let y = Math.round(Math.random() * boardHeight / segmentDim) * segmentDim - segmentDim; // keep food on map\n\n  if (x > boardWidth) {\n    x = boardWidth - segmentDim;\n  }\n\n  if (x < 0) {\n    x = 0;\n  }\n\n  if (y > boardHeight) {\n    y = boardHeight - segmentDim;\n  }\n\n  if (y < 0) {\n    y = 0;\n  }\n\n  return [x, y];\n}\n\nfunction spawnFood() {\n  foodCord = randomBoardCord();\n  d3.select('#board').append('rect').attr(\"id\", \"food\").attr(\"width\", segmentDim).attr(\"height\", segmentDim).attr(\"x\", foodCord[0]).attr(\"y\", foodCord[1]).attr(\"ry\", segmentRadius).attr(\"rx\", segmentRadius).attr(\"fill\", \"limegreen\").style(\"opacity\", 0).transition().duration(1000).style(\"opacity\", 1);\n  foodOnBoard = true;\n}\n\nfunction spawnBomb() {\n  bombCord = randomBoardCord();\n  bombCount = 5;\n  d3.select('#board').append('rect').attr(\"id\", \"bomb\").attr(\"width\", segmentDim).attr(\"height\", segmentDim).attr(\"x\", bombCord[0]).attr(\"y\", bombCord[1]).attr(\"ry\", segmentRadius).attr(\"rx\", segmentRadius).attr(\"fill\", \"orange\").style(\"opacity\", 0).attr(\"stroke\", \"red\").transition().duration(1000).style(\"opacity\", 1);\n  d3.select('#board').append('text').attr('id', 'bombText').text(bombCount).style('fill', 'black').style('font-size', '80%').attr(\"transform\", \"translate(\" + (bombCord[0] + segmentDim / 4) + \",\" + (bombCord[1] + segmentDim - 1) + \")\");\n  liveBomb = true;\n}\n\nfunction moveSnake(index, cord) {\n  d3.select('#segment' + index).attr(\"x\", cord[0]).attr(\"y\", cord[1]);\n\n  if (+index !== snakeBody.length - 1) {\n    let nextIdx = index + 1;\n    let oldCord = snakeBody[index];\n    moveSnake(nextIdx, oldCord);\n  }\n\n  snakeBody[index] = [cord[0], cord[1]];\n}\n\nfunction gameLost() {\n  clearTimeout(gameTicker);\n  console.warn('Game over.');\n  d3.select('#board').remove();\n  d3.select('#gameSpace').append('h3').text('GAME OVER').attr('id', 'endText');\n  d3.select('#gameSpace').append('p').attr('id', 'tryAgain').text('try again').style('cursor', 'pointer').on(\"click\", function () {\n    console.log('Try again clicked.');\n    d3.select('#endText').remove();\n    d3.select('#tryAgain').remove();\n    initGame();\n  });\n}\n\nfunction bombGoesBoom() {\n  let explosion = [];\n  let colorScale = d3.scaleLinear().domain([1, bombRadius]).range(['red', 'yellow']);\n\n  for (let i = 1; i <= bombRadius; i++) {\n    let cord = [bombCord[0] + segmentDim, bombCord[1]];\n    explosion.push(cord); // right\n\n    d3.select('#board').append('rect').attr(\"class\", \"boom\").attr(\"width\", segmentDim).attr(\"height\", segmentDim).attr(\"x\", bombCord[0] + segmentDim * i).attr(\"y\", bombCord[1]).attr(\"ry\", segmentRadius).attr(\"rx\", segmentRadius).attr(\"fill\", colorScale(i)).style(\"opacity\", 1).attr(\"stroke\", \"red\").transition().duration(1500).style(\"opacity\", 0).remove(); // left\n\n    d3.select('#board').append('rect').attr(\"class\", \"boom\").attr(\"width\", segmentDim).attr(\"height\", segmentDim).attr(\"x\", bombCord[0] - segmentDim * i).attr(\"y\", bombCord[1]).attr(\"ry\", segmentRadius).attr(\"rx\", segmentRadius).attr(\"fill\", colorScale(i)).style(\"opacity\", 1).attr(\"stroke\", \"red\").transition().duration(1500).style(\"opacity\", 0).remove();\n    d3.select('#board').append('rect').attr(\"class\", \"boom\").attr(\"width\", segmentDim).attr(\"height\", segmentDim).attr(\"x\", bombCord[0]).attr(\"y\", bombCord[1] + segmentDim * i).attr(\"ry\", segmentRadius).attr(\"rx\", segmentRadius).attr(\"fill\", colorScale(i)).style(\"opacity\", 1).attr(\"stroke\", \"red\").transition().duration(1500).style(\"opacity\", 0).remove();\n    d3.select('#board').append('rect').attr(\"class\", \"boom\").attr(\"width\", segmentDim).attr(\"height\", segmentDim).attr(\"x\", bombCord[0]).attr(\"y\", bombCord[1] - segmentDim * i).attr(\"ry\", segmentRadius).attr(\"rx\", segmentRadius).attr(\"fill\", colorScale(i)).style(\"opacity\", 1).attr(\"stroke\", \"red\").transition().duration(1500).style(\"opacity\", 0).remove();\n  }\n\n  d3.select('#bombText').remove();\n  d3.select('#bomb').transition().duration(1500).style(\"opacity\", 0).remove();\n  bombCount = 0;\n  liveBomb = false; // ToDo:\n  // cut snake body if body within radius\n\n  isHeadInExplosion();\n}\n\nfunction isHeadInExplosion() {\n  let explosionXRange = [bombCord[0] - segmentDim * bombRadius, bombCord[0] + segmentDim * bombRadius];\n  let explosionYRange = [bombCord[1] - segmentDim * bombRadius, bombCord[1] + segmentDim * bombRadius];\n  let detectX = headCord[0] >= explosionXRange[0] && headCord[0] <= explosionXRange[1];\n  let detectY = headCord[1] >= explosionYRange[0] && headCord[1] <= explosionYRange[1];\n\n  if (detectX && detectY) {\n    console.log(\"Ouch, killed by a bomb...\");\n    gameLost();\n  }\n}\n\nfunction gameTick() {\n  count++;\n\n  if (snakeDirection === 'ArrowLeft') {\n    headCord[0] = headCord[0] - segmentDim;\n  } else if (snakeDirection === 'ArrowUp') {\n    headCord[1] = headCord[1] - segmentDim;\n  } else if (snakeDirection === 'ArrowRight') {\n    headCord[0] = headCord[0] + segmentDim;\n  } else if (snakeDirection === 'ArrowDown') {\n    headCord[1] = headCord[1] + segmentDim;\n  } //headCord = [0,0]\n\n\n  snakeTail = [snakeBody[snakeBody.length - 1][0], snakeBody[snakeBody.length - 1][1]];\n  moveSnake(0, headCord);\n\n  if (foodCord.length > 0) {\n    if (foodCord[0] === headCord[0] && foodCord[1] === headCord[1]) {\n      console.warn('FOOD EATEN!!!');\n      score++;\n\n      if (speed > 100) {\n        speed = speed - 25;\n      }\n\n      document.getElementById('score').innerHTML = score;\n      d3.select('#food').remove();\n      foodOnBoard = false;\n      snakeBody.push(snakeTail);\n      d3.select('#board').append('rect').attr(\"class\", \"snake\").attr(\"id\", \"segment\" + (snakeBody.length - 1)).attr(\"width\", segmentDim).attr(\"height\", segmentDim).attr(\"x\", snakeTail[0]).attr(\"y\", snakeTail[1]).attr(\"ry\", segmentRadius).attr(\"rx\", segmentRadius).attr(\"fill\", \"purple\");\n    }\n  }\n\n  if (count % 5 === 0 && !foodOnBoard) {\n    spawnFood();\n  } // bomb tick\n\n\n  if (liveBomb) {\n    console.log('This bomb is ticking...', bombCount); // count down in seconds\n\n    let slowCount = Math.round(1000 / speed);\n\n    if (+bombCount > 0 && count % slowCount === 1) {\n      bombCount = bombCount - 1;\n      d3.select('#bombText').text(bombCount);\n    } else if (bombCount <= 0) {\n      // boom\n      console.warn(\"Boom!\");\n      bombGoesBoom();\n    }\n  } // spawn bomb\n\n\n  if (score > 0 && count % 10 === 0 && !liveBomb) {\n    spawnBomb();\n  } // losing conditions\n\n\n  if (headCord[0] > boardWidth || headCord[0] < 0 || headCord[1] < 0 || headCord[1] > boardHeight) {\n    console.warn('Snakes out of the box!');\n    gameLost();\n    return;\n  }\n\n  for (let segment of snakeBody) {\n    if (snakeBody.indexOf(segment) === 0) {\n      continue;\n    }\n\n    if (headCord[0] === segment[0] && headCord[1] === segment[1]) {\n      console.warn('You bit your own tail...');\n      gameLost();\n      return;\n    }\n  }\n\n  gameTicker = setTimeout(function () {\n    gameTick();\n  }, speed);\n}","map":{"version":3,"sources":["/Users/williamvennard/my-app/src/SnakeApp.js"],"names":["gameTicker","playing","count","segmentDim","boardWidth","boardHeight","segmentRadius","foodCord","headCord","snakeBody","foodOnBoard","score","speed","snakeTail","snakeDirection","lastSnakeDirection","bombCord","liveBomb","bombCount","bombRadius","setClickFunction","d3","select","on","console","log","style","initGame","warn","document","addEventListener","event","key","preventDefault","push","append","attr","length","getElementById","innerHTML","spawnFood","gameTick","randomBoardCord","x","Math","round","random","y","transition","duration","spawnBomb","text","moveSnake","index","cord","nextIdx","oldCord","gameLost","clearTimeout","remove","bombGoesBoom","explosion","colorScale","scaleLinear","domain","range","i","isHeadInExplosion","explosionXRange","explosionYRange","detectX","detectY","slowCount","segment","indexOf","setTimeout"],"mappings":"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","sourcesContent":["// snake\nlet gameTicker;\nlet playing = false;\nlet count = 0;\nconst segmentDim = 10;\nconst boardWidth = 300;\nconst boardHeight = 300;\nconst segmentRadius = 5;\nlet foodCord = [];\n\nlet headCord = [];\nlet snakeBody = [];\nlet foodOnBoard = false;\nlet score = 0;\nlet speed = 200;\nlet snakeTail = [];\nlet snakeDirection = 'ArrowRight';\nlet lastSnakeDirection = '';\n// bomb stuff\nlet bombCord = [];\nlet liveBomb = false;\nlet bombCount = 0;\nlet bombRadius = 2;\n\n\nexport function setClickFunction() {\n  d3.select('#start-snake').on('click', function() {\n    console.log('d3 click home, start game')\n    // if playing\n    if (playing) {\n      d3.select('#homeInfo').style('display', 'inline')\n      playing = false;\n    } else {\n      d3.select('#homeInfo').style('display', 'none')\n      d3.select('#snakeGame').style('display', 'inline')\n      initGame()\n      playing = true;\n    }\n  })\n}\n\nconsole.warn(\"IS this loaded?\", d3.select('#start-snake'))\nsetClickFunction();\n\ndocument.addEventListener('keydown', (event) => {\n  if(event.key === 'ArrowLeft' || event.key === 'ArrowUp' || event.key === 'ArrowRight' || event.key === 'ArrowDown') {\n    event.preventDefault();\n    if (snakeDirection === 'ArrowLeft' && event.key === 'ArrowRight') { return }\n    if (snakeDirection === 'ArrowRight' && event.key === 'ArrowLeft') { return }\n    if (snakeDirection === 'ArrowUp' && event.key === 'ArrowDown') { return }\n    if (snakeDirection === 'ArrowDown' && event.key === 'ArrowUp') { return }\n    snakeDirection = event.key;\n  }\n});\n\nfunction initGame() {\n  headCord = [0,0];\n  snakeBody = [];\n  score = 0;\n  speed = 200;\n  bombCount = 0\n  snakeDirection = 'ArrowRight';\n  snakeBody.push(headCord);\n\n  d3.select('#gameSpace')\n    .append('svg')\n    .attr('id', 'board')\n    .attr('width', boardWidth)\n    .attr('height', boardHeight)\n    .append('rect')\n    .attr('class', 'snake head')\n    .attr(\"id\", \"segment\" + (snakeBody.length-1))\n    .attr('width', segmentDim)\n    .attr('height', segmentDim)\n    .attr('x', headCord[0])\n    .attr('y', headCord[1])\n    .attr(\"ry\", segmentRadius)\n    .attr(\"rx\", segmentRadius)\n    .attr('fill', 'red')\n\n  document.getElementById('score').innerHTML = score;\n  spawnFood();\n  gameTick();\n}\n\nfunction randomBoardCord() {\n  let x = (Math.round(Math.random()*boardWidth/segmentDim)*segmentDim) - segmentDim;\n  let y = (Math.round(Math.random()*boardHeight/segmentDim)*segmentDim) - segmentDim;\n  // keep food on map\n  if (x > boardWidth) { x = boardWidth - segmentDim}\n  if (x < 0) { x = 0 }\n  if (y > boardHeight) {y = boardHeight - segmentDim}\n  if (y < 0) { y = 0 }\n\n  return [x,y];\n}\n\nfunction spawnFood() {\n  foodCord = randomBoardCord()\n\n  d3.select('#board').append('rect')\n    .attr(\"id\", \"food\")\n    .attr(\"width\", segmentDim)\n    .attr(\"height\", segmentDim)\n    .attr(\"x\", foodCord[0])\n    .attr(\"y\", foodCord[1])\n    .attr(\"ry\", segmentRadius)\n    .attr(\"rx\", segmentRadius)\n    .attr(\"fill\", \"limegreen\")\n    .style(\"opacity\", 0)\n    .transition()\n    .duration(1000)\n    .style(\"opacity\", 1)\n\n  foodOnBoard = true;\n}\n\nfunction spawnBomb() {\n  bombCord = randomBoardCord();\n  bombCount = 5;\n  d3.select('#board').append('rect')\n    .attr(\"id\", \"bomb\")\n    .attr(\"width\", segmentDim)\n    .attr(\"height\", segmentDim)\n    .attr(\"x\", bombCord[0])\n    .attr(\"y\", bombCord[1])\n    .attr(\"ry\", segmentRadius)\n    .attr(\"rx\", segmentRadius)\n    .attr(\"fill\", \"orange\")\n    .style(\"opacity\", 0)\n    .attr(\"stroke\", \"red\")\n    .transition()\n    .duration(1000)\n    .style(\"opacity\", 1)\n\n  d3.select('#board').append('text')\n    .attr('id', 'bombText')\n    .text(bombCount)\n    .style('fill', 'black')\n    .style('font-size', '80%')\n    .attr(\"transform\", \"translate(\"+(bombCord[0]+segmentDim/4)+\",\"+(bombCord[1]+segmentDim-1)+\")\");\n\n  liveBomb = true;\n}\n\nfunction moveSnake(index, cord) {\n  d3.select('#segment' + index)\n    .attr(\"x\", cord[0])\n    .attr(\"y\", cord[1]);\n\n  if (+index !== snakeBody.length-1) {\n    let nextIdx = index + 1;\n    let oldCord = snakeBody[index];\n    moveSnake(nextIdx, oldCord)\n  }\n  snakeBody[index] = [cord[0], cord[1]];\n}\n\nfunction gameLost() {\n  clearTimeout(gameTicker);\n  console.warn('Game over.')\n  d3.select('#board').remove();\n\n  d3.select('#gameSpace')\n    .append('h3')\n    .text('GAME OVER')\n    .attr('id', 'endText')\n\n  d3.select('#gameSpace')\n    .append('p')\n    .attr('id', 'tryAgain')\n    .text('try again')\n    .style('cursor', 'pointer')\n    .on(\"click\", function() {\n      console.log('Try again clicked.')\n      d3.select('#endText').remove();\n      d3.select('#tryAgain').remove();\n      initGame()\n    })\n}\n\nfunction bombGoesBoom() {\n  let explosion = [];\n  let colorScale = d3.scaleLinear()\n    .domain([1, bombRadius])\n    .range(['red', 'yellow']);\n\n  for(let i = 1; i <= bombRadius; i++) {\n    let cord = [bombCord[0]+segmentDim, bombCord[1]]\n    explosion.push(cord)\n    // right\n    d3.select('#board').append('rect')\n      .attr(\"class\", \"boom\")\n      .attr(\"width\", segmentDim)\n      .attr(\"height\", segmentDim)\n      .attr(\"x\", bombCord[0]+segmentDim*i)\n      .attr(\"y\", bombCord[1])\n      .attr(\"ry\", segmentRadius)\n      .attr(\"rx\", segmentRadius)\n      .attr(\"fill\", colorScale(i))\n      .style(\"opacity\", 1)\n      .attr(\"stroke\", \"red\")\n      .transition()\n      .duration(1500)\n      .style(\"opacity\", 0)\n      .remove();\n    // left\n    d3.select('#board').append('rect')\n      .attr(\"class\", \"boom\")\n      .attr(\"width\", segmentDim)\n      .attr(\"height\", segmentDim)\n      .attr(\"x\", bombCord[0]-segmentDim*i)\n      .attr(\"y\", bombCord[1])\n      .attr(\"ry\", segmentRadius)\n      .attr(\"rx\", segmentRadius)\n      .attr(\"fill\", colorScale(i))\n      .style(\"opacity\", 1)\n      .attr(\"stroke\", \"red\")\n      .transition()\n      .duration(1500)\n      .style(\"opacity\", 0)\n      .remove();\n\n    d3.select('#board').append('rect')\n      .attr(\"class\", \"boom\")\n      .attr(\"width\", segmentDim)\n      .attr(\"height\", segmentDim)\n      .attr(\"x\", bombCord[0])\n      .attr(\"y\", bombCord[1]+segmentDim*i)\n      .attr(\"ry\", segmentRadius)\n      .attr(\"rx\", segmentRadius)\n      .attr(\"fill\", colorScale(i))\n      .style(\"opacity\", 1)\n      .attr(\"stroke\", \"red\")\n      .transition()\n      .duration(1500)\n      .style(\"opacity\", 0)\n      .remove();\n\n    d3.select('#board').append('rect')\n      .attr(\"class\", \"boom\")\n      .attr(\"width\", segmentDim)\n      .attr(\"height\", segmentDim)\n      .attr(\"x\", bombCord[0])\n      .attr(\"y\", bombCord[1]-segmentDim*i)\n      .attr(\"ry\", segmentRadius)\n      .attr(\"rx\", segmentRadius)\n      .attr(\"fill\", colorScale(i))\n      .style(\"opacity\", 1)\n      .attr(\"stroke\", \"red\")\n      .transition()\n      .duration(1500)\n      .style(\"opacity\", 0)\n      .remove();\n  }\n\n  d3.select('#bombText').remove();\n  d3.select('#bomb')\n    .transition()\n    .duration(1500)\n    .style(\"opacity\", 0)\n    .remove();\n\n  bombCount = 0;\n  liveBomb = false;\n\n  // ToDo:\n  // cut snake body if body within radius\n  isHeadInExplosion()\n\n}\n\nfunction isHeadInExplosion() {\n  let explosionXRange = [bombCord[0]-segmentDim*bombRadius, bombCord[0]+segmentDim*bombRadius];\n  let explosionYRange = [bombCord[1]-segmentDim*bombRadius, bombCord[1]+segmentDim*bombRadius];\n  let detectX = headCord[0] >= explosionXRange[0] && headCord[0] <= explosionXRange[1];\n  let detectY = headCord[1] >= explosionYRange[0] && headCord[1] <= explosionYRange[1];\n  if (detectX && detectY) {\n    console.log(\"Ouch, killed by a bomb...\")\n    gameLost();\n  }\n}\n\nfunction gameTick() {\n  count++;\n  if(snakeDirection === 'ArrowLeft') {\n    headCord[0] = headCord[0] - segmentDim;\n  }else if(snakeDirection === 'ArrowUp') {\n    headCord[1] = headCord[1] - segmentDim;\n  }else if(snakeDirection === 'ArrowRight') {\n    headCord[0] = headCord[0] + segmentDim;\n  }else if(snakeDirection === 'ArrowDown') {\n    headCord[1] = headCord[1] + segmentDim;\n  }\n  //headCord = [0,0]\n  snakeTail = [snakeBody[snakeBody.length-1][0], snakeBody[snakeBody.length-1][1]];\n  moveSnake(0, headCord);\n\n  if (foodCord.length > 0) {\n    if(foodCord[0] === headCord[0] && foodCord[1] === headCord[1]) {\n      console.warn('FOOD EATEN!!!')\n      score++;\n      if (speed > 100) {\n        speed = speed-25;\n      }\n\n      document.getElementById('score').innerHTML = score;\n\n      d3.select('#food').remove();\n      foodOnBoard = false;\n\n      snakeBody.push(snakeTail)\n\n      d3.select('#board').append('rect')\n        .attr(\"class\", \"snake\")\n        .attr(\"id\", \"segment\" + (snakeBody.length-1))\n        .attr(\"width\", segmentDim)\n        .attr(\"height\", segmentDim)\n        .attr(\"x\", snakeTail[0])\n        .attr(\"y\", snakeTail[1])\n        .attr(\"ry\", segmentRadius)\n        .attr(\"rx\", segmentRadius)\n        .attr(\"fill\", \"purple\");\n    }\n  }\n\n  if(count%5 === 0 && !foodOnBoard) {\n    spawnFood();\n  }\n\n  // bomb tick\n  if (liveBomb) {\n    console.log('This bomb is ticking...', bombCount)\n    // count down in seconds\n    let slowCount = Math.round(1000/speed);\n    if (+bombCount > 0 && count%slowCount === 1) {\n      bombCount = bombCount - 1;\n      d3.select('#bombText')\n        .text(bombCount)\n    } else if (bombCount <= 0){\n      // boom\n      console.warn(\"Boom!\")\n      bombGoesBoom();\n    }\n  }\n\n  // spawn bomb\n  if(score > 0 && count%10 === 0 && !liveBomb) {\n    spawnBomb();\n  }\n\n  // losing conditions\n  if(headCord[0] > boardWidth || headCord[0] < 0 || headCord[1] < 0 || headCord[1] > boardHeight) {\n    console.warn('Snakes out of the box!')\n    gameLost();\n    return\n  }\n  for (let segment of snakeBody) {\n    if (snakeBody.indexOf(segment) === 0) {\n      continue\n    }\n    if(headCord[0] === segment[0] && headCord[1] === segment[1]) {\n      console.warn('You bit your own tail...')\n      gameLost()\n      return\n    }\n  }\n\n  gameTicker = setTimeout(function() {\n    gameTick()\n  }, speed);\n}\n"]},"metadata":{},"sourceType":"module"}