{"ast":null,"code":"import _classCallCheck from\"/Users/williamvennard/my-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/williamvennard/my-app/node_modules/@babel/runtime/helpers/esm/createClass\";import*as d3 from\"d3\";function initKeyBindings(){document.addEventListener('keydown',function(event){if(event.key==='ArrowLeft'||event.key==='ArrowUp'||event.key==='ArrowRight'||event.key==='ArrowDown'){event.preventDefault();if(snakeGame.snakeDirection==='ArrowLeft'&&event.key==='ArrowRight'){return;}if(snakeGame.snakeDirection==='ArrowRight'&&event.key==='ArrowLeft'){return;}if(snakeGame.snakeDirection==='ArrowUp'&&event.key==='ArrowDown'){return;}if(snakeGame.snakeDirection==='ArrowDown'&&event.key==='ArrowUp'){return;}snakeGame.snakeDirection=event.key;}});}var SnakeGame=/*#__PURE__*/function(){function SnakeGame(){_classCallCheck(this,SnakeGame);this.playing=false;this.count=0;this.foodCord=[];this.headCord=[];this.snakeBody=[];this.foodOnBoard=false;this.score=0;this.speed=200;this.snakeTail=[];this.snakeDirection='ArrowRight';this.lastSnakeDirection='';this.gameTicker=\"\";this.segmentDim=10;this.boardWidth=300;this.boardHeight=300;this.segmentRadius=5;}// Might be a better way to do this.\n// put into another class and simply reset?\n_createClass(SnakeGame,[{key:\"initGame\",value:function initGame(){d3.select('#score').style(\"display\",\"block\");d3.select('#start-game').style(\"display\",\"none\");d3.select('#board').remove();d3.select('#end-text').remove();this.headCord=[0,0];this.snakeBody=[];this.score=0;this.speed=200;this.bombCount=0;this.snakeDirection='ArrowRight';this.snakeBody.push(this.headCord);this.playing=true;initKeyBindings();d3.select('#game-space').append('svg').attr('id','board').attr('width',this.boardWidth).attr('height',this.boardHeight).append('rect').attr('class','snake head').attr(\"id\",\"segment\"+(this.snakeBody.length-1)).attr('width',this.segmentDim).attr('height',this.segmentDim).attr('x',this.headCord[0]).attr('y',this.headCord[1]).attr(\"ry\",this.segmentRadius).attr(\"rx\",this.segmentRadius).attr('fill','red');// do this with d3\nd3.select('#score-count').text(this.score);this.spawnFood();this.gameTick();}},{key:\"randomBoardCord\",value:function randomBoardCord(){var segDim=this.segmentDim;var x=Math.round(Math.random()*this.boardWidth/segDim)*segDim-segDim;var y=Math.round(Math.random()*this.boardHeight/segDim)*segDim-segDim;// keep food on map\nif(x>this.boardWidth){x=this.boardWidth-segDim;}if(x<0){x=0;}if(y>this.boardHeight){y=this.boardHeight-segDim;}if(y<0){y=0;}return[x,y];}},{key:\"spawnFood\",value:function spawnFood(){this.foodCord=this.randomBoardCord();d3.select('#board').append('rect').attr(\"id\",\"food\").attr(\"width\",this.segmentDim).attr(\"height\",this.segmentDim).attr(\"x\",this.foodCord[0]).attr(\"y\",this.foodCord[1]).attr(\"ry\",this.segmentRadius).attr(\"rx\",this.segmentRadius).attr(\"fill\",\"limegreen\").style(\"opacity\",0).transition().duration(1000).style(\"opacity\",1);this.foodOnBoard=true;}},{key:\"moveSnake\",value:function moveSnake(index,cord){d3.select('#segment'+index).attr(\"x\",cord[0]).attr(\"y\",cord[1]);if(+index!==this.snakeBody.length-1){var nextIdx=index+1;var oldCord=this.snakeBody[index];this.moveSnake(nextIdx,oldCord);}this.snakeBody[index]=[cord[0],cord[1]];}},{key:\"gameLost\",value:function gameLost(){clearTimeout(this.gameTicker);console.log('Game over.');if(!this.playing){return;}this.playing=false;// remove old stuff and show game over\nd3.select('#food').transition().duration(1000).style(\"opacity\",0).remove();d3.selectAll(\".snake\").transition().duration(1000).style(\"opacity\",0).remove();d3.select('#bomb-text').remove();d3.select('#bomb').transition().duration(1000).style(\"opacity\",0).remove();d3.select('#end-text').remove();d3.select('#game-space').append('h3').text('GAME OVER').attr('id','end-text').style(\"opacity\",0).transition().duration(1000).style(\"opacity\",1);d3.select('#start-game').style(\"display\",\"block\");}},{key:\"gameTick\",value:function gameTick(){this.count++;if(this.snakeDirection==='ArrowLeft'){this.headCord[0]=this.headCord[0]-this.segmentDim;}else if(this.snakeDirection==='ArrowUp'){this.headCord[1]=this.headCord[1]-this.segmentDim;}else if(this.snakeDirection==='ArrowRight'){this.headCord[0]=this.headCord[0]+this.segmentDim;}else if(this.snakeDirection==='ArrowDown'){this.headCord[1]=this.headCord[1]+this.segmentDim;}//headCord = [0,0]\nthis.snakeTail=[this.snakeBody[this.snakeBody.length-1][0],this.snakeBody[this.snakeBody.length-1][1]];this.moveSnake(0,this.headCord);if(this.foodCord.length>0){if(this.foodCord[0]===this.headCord[0]&&this.foodCord[1]===this.headCord[1]){console.warn('FOOD EATEN!!!');this.score++;if(this.speed>100){this.speed=this.speed-10;}d3.select(\"#score-count\").text(this.score);d3.select('#food').remove();this.foodOnBoard=false;this.snakeBody.push(this.snakeTail);d3.select('#board').append('rect').attr(\"class\",\"snake\").attr(\"id\",\"segment\"+(this.snakeBody.length-1)).attr(\"width\",this.segmentDim).attr(\"height\",this.segmentDim).attr(\"x\",this.snakeTail[0]).attr(\"y\",this.snakeTail[1]).attr(\"ry\",this.segmentRadius).attr(\"rx\",this.segmentRadius).attr(\"fill\",\"purple\");}}if(this.count%5===0&&!this.foodOnBoard){this.spawnFood();}// put bomb stuff in seperate function\nif(this.snakeBombs===undefined){this.snakeBombs=new SnakeBombs(this);}// bomb tick\nif(this.snakeBombs.liveBomb){//console.log('This bomb is ticking...', this.snakeBombs.bombCount)\n// count down in seconds\nvar slowCount=Math.round(1000/this.speed);if(+this.snakeBombs.bombCount>0&&this.count%slowCount===1){this.snakeBombs.bombCount=this.snakeBombs.bombCount-1;d3.select('#bomb-text').text(this.snakeBombs.bombCount);}else if(this.snakeBombs.bombCount<=0){// boom\nconsole.log(\"Boom!\");this.snakeBombs.bombGoesBoom();}}// spawn bomb\nif(this.score>0&&this.count%10===0&&!this.snakeBombs.liveBomb){this.snakeBombs.spawnBomb();}// losing conditions\nif(this.headCord[0]>=this.boardWidth||this.headCord[0]<0// off the sides \n||this.headCord[1]<0||this.headCord[1]>=this.boardHeight){// off the top or bottom\nconsole.log('Snakes out of the box!');this.gameLost();return;}var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=this.snakeBody[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var segment=_step.value;if(this.snakeBody.indexOf(segment)===0){continue;}if(this.headCord[0]===segment[0]&&this.headCord[1]===segment[1]){console.log('You bit your own tail...');this.gameLost();return;}}}catch(err){_didIteratorError=true;_iteratorError=err;}finally{try{if(!_iteratorNormalCompletion&&_iterator.return!=null){_iterator.return();}}finally{if(_didIteratorError){throw _iteratorError;}}}var that=this;this.gameTicker=setTimeout(function(){that.gameTick();},that.speed);}}]);return SnakeGame;}();var SnakeBombs=/*#__PURE__*/function(){function SnakeBombs(snakeGame){_classCallCheck(this,SnakeBombs);this.snakeGame=snakeGame;this.bombCord=[];this.liveBomb=false;this.bombCount=0;this.explosionRadius=2;}_createClass(SnakeBombs,[{key:\"spawnBomb\",value:function spawnBomb(){this.bombCord=this.snakeGame.randomBoardCord();this.bombCount=5;d3.select('#board').append('rect').attr(\"id\",\"bomb\").attr(\"width\",this.snakeGame.segmentDim).attr(\"height\",this.snakeGame.segmentDim).attr(\"x\",this.bombCord[0]).attr(\"y\",this.bombCord[1]).attr(\"ry\",this.snakeGame.segmentRadius).attr(\"rx\",this.snakeGame.segmentRadius).attr(\"fill\",\"orange\").style(\"opacity\",0).attr(\"stroke\",\"red\").transition().duration(1000).style(\"opacity\",1);d3.select('#board').append('text').attr('id','bomb-text').text(this.bombCount).style('fill','black').style('font-size','65%').attr(\"transform\",\"translate(\"+(this.bombCord[0]+this.snakeGame.segmentDim/4)+\",\"+(this.bombCord[1]+this.snakeGame.segmentDim-1)+\")\");this.liveBomb=true;}},{key:\"bombGoesBoom\",value:function bombGoesBoom(){var colorScale=d3.scaleLinear().domain([0,this.explosionRadius]).range(['red','yellow']);var explosionArea=[];for(var i=1;i<=this.explosionRadius;i++){var start=this.bombCord;for(var xDim=-i;xDim<=i;xDim++){for(var yDim=-i;yDim<=i;yDim++){var newX=start[0]+xDim*this.snakeGame.segmentDim;var newY=start[1]+yDim*this.snakeGame.segmentDim;var newCord=[newX,newY];if(!explosionArea.includes(newCord)){explosionArea.push(newCord);}}}}for(var _i=0,_explosionArea=explosionArea;_i<_explosionArea.length;_i++){var block=_explosionArea[_i];// distance in block units\nvar distance=distanceBetweenPoints(this.bombCord,block)/this.snakeGame.segmentDim;d3.select('#board').append('rect').attr(\"class\",\"boom\").attr(\"width\",this.snakeGame.segmentDim).attr(\"height\",this.snakeGame.segmentDim).attr(\"x\",block[0]).attr(\"y\",block[1]).attr(\"ry\",this.snakeGame.segmentRadius).attr(\"rx\",this.snakeGame.segmentRadius).attr(\"fill\",colorScale(distance)).style(\"opacity\",1).attr(\"stroke\",\"red\").transition().duration(1500).style(\"opacity\",0).attr(\"fill\",\"blue\").attr(\"width\",1).attr(\"height\",1).remove();}d3.select('#bomb-text').remove();d3.select('#bomb').transition().duration(1500).style(\"opacity\",0).remove();this.bombCount=0;this.liveBomb=false;this.isHeadInExplosion();}},{key:\"isHeadInExplosion\",value:function isHeadInExplosion(){var bombR=this.explosionRadius;var segDim=this.snakeGame.segmentDim;var explosionXRange=[this.bombCord[0]-segDim*bombR,this.bombCord[0]+segDim*bombR];var explosionYRange=[this.bombCord[1]-segDim*bombR,this.bombCord[1]+segDim*bombR];var detectX=this.snakeGame.headCord[0]>=explosionXRange[0]&&this.snakeGame.headCord[0]<=explosionXRange[1];var detectY=this.snakeGame.headCord[1]>=explosionYRange[0]&&this.snakeGame.headCord[1]<=explosionYRange[1];if(detectX&&detectY){console.log(\"Ouch, killed by a bomb...\");this.snakeGame.gameLost();}}}]);return SnakeBombs;}();function distanceBetweenPoints(pointA,pointB){var x0=pointA[0];var x1=pointB[0];var y0=pointA[1];var y1=pointB[1];var x=Math.pow(x1-x0,2);var y=Math.pow(y1-y0,2);var distance=Math.pow(x+y,0.5);return distance;}var snakeGame=new SnakeGame();export function startSnakeGame(){console.log('startSnakeGame: Start game!!');snakeGame.initGame();}","map":{"version":3,"sources":["/Users/williamvennard/my-app/src/SnakeApp.js"],"names":["d3","initKeyBindings","document","addEventListener","event","key","preventDefault","snakeGame","snakeDirection","SnakeGame","playing","count","foodCord","headCord","snakeBody","foodOnBoard","score","speed","snakeTail","lastSnakeDirection","gameTicker","segmentDim","boardWidth","boardHeight","segmentRadius","select","style","remove","bombCount","push","append","attr","length","text","spawnFood","gameTick","segDim","x","Math","round","random","y","randomBoardCord","transition","duration","index","cord","nextIdx","oldCord","moveSnake","clearTimeout","console","log","selectAll","warn","snakeBombs","undefined","SnakeBombs","liveBomb","slowCount","bombGoesBoom","spawnBomb","gameLost","segment","indexOf","that","setTimeout","bombCord","explosionRadius","colorScale","scaleLinear","domain","range","explosionArea","i","start","xDim","yDim","newX","newY","newCord","includes","block","distance","distanceBetweenPoints","isHeadInExplosion","bombR","explosionXRange","explosionYRange","detectX","detectY","pointA","pointB","x0","x1","y0","y1","pow","startSnakeGame","initGame"],"mappings":"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","sourcesContent":["import * as d3 from \"d3\";\n\n\nfunction initKeyBindings () {\n  document.addEventListener('keydown', (event) => {\n    if(event.key === 'ArrowLeft' || event.key === 'ArrowUp' || event.key === 'ArrowRight' || event.key === 'ArrowDown') {\n      event.preventDefault();\n      if (snakeGame.snakeDirection === 'ArrowLeft' && event.key === 'ArrowRight') { return }\n      if (snakeGame.snakeDirection === 'ArrowRight' && event.key === 'ArrowLeft') { return }\n      if (snakeGame.snakeDirection === 'ArrowUp' && event.key === 'ArrowDown') { return }\n      if (snakeGame.snakeDirection === 'ArrowDown' && event.key === 'ArrowUp') { return }\n      snakeGame.snakeDirection = event.key;\n    }\n  });\n}\n\nclass SnakeGame {\n  constructor() {\n    this.playing = false;\n    this.count = 0;\n    this.foodCord = [];\n    this.headCord = [];\n    this.snakeBody = [];\n    this.foodOnBoard = false;\n    this.score = 0;\n    this.speed = 200;\n    this.snakeTail = [];\n    this.snakeDirection = 'ArrowRight';\n    this.lastSnakeDirection = '';\n    this.gameTicker = \"\";\n    this.segmentDim = 10;\n    this.boardWidth = 300;\n    this.boardHeight = 300;\n    this.segmentRadius = 5;\n\n  }\n\n  // Might be a better way to do this.\n  // put into another class and simply reset?\n  initGame() {\n    d3.select('#score').style(\"display\", \"block\")\n    d3.select('#start-game').style(\"display\", \"none\")\n    d3.select('#board').remove();\n    d3.select('#end-text').remove();\n    this.headCord = [0,0];\n    this.snakeBody = [];\n    this.score = 0;\n    this.speed = 200;\n    this.bombCount = 0\n    this.snakeDirection = 'ArrowRight';\n    this.snakeBody.push(this.headCord);\n    this.playing = true;\n\n    initKeyBindings();\n\n    d3.select('#game-space')\n      .append('svg')\n      .attr('id', 'board')\n      .attr('width', this.boardWidth)\n      .attr('height', this.boardHeight)\n      .append('rect')\n      .attr('class', 'snake head')\n      .attr(\"id\", \"segment\" + (this.snakeBody.length-1))\n      .attr('width', this.segmentDim)\n      .attr('height', this.segmentDim)\n      .attr('x', this.headCord[0])\n      .attr('y', this.headCord[1])\n      .attr(\"ry\", this.segmentRadius)\n      .attr(\"rx\", this.segmentRadius)\n      .attr('fill', 'red')\n\n    // do this with d3\n    d3.select('#score-count')\n      .text(this.score)\n\n    this.spawnFood();\n    this.gameTick();\n  }\n\n  randomBoardCord() {\n    let segDim = this.segmentDim;\n    let x = (Math.round(Math.random()*this.boardWidth/segDim)*segDim) - segDim;\n    let y = (Math.round(Math.random()*this.boardHeight/segDim)*segDim) - segDim;\n    // keep food on map\n    if (x > this.boardWidth) { x = this.boardWidth - segDim}\n    if (x < 0) { x = 0 }\n    if (y > this.boardHeight) {y = this.boardHeight - segDim}\n    if (y < 0) { y = 0 }\n\n    return [x,y];\n  }\n\n  spawnFood() {\n    this.foodCord = this.randomBoardCord()\n\n    d3.select('#board').append('rect')\n      .attr(\"id\", \"food\")\n      .attr(\"width\", this.segmentDim)\n      .attr(\"height\", this.segmentDim)\n      .attr(\"x\", this.foodCord[0])\n      .attr(\"y\", this.foodCord[1])\n      .attr(\"ry\", this.segmentRadius)\n      .attr(\"rx\", this.segmentRadius)\n      .attr(\"fill\", \"limegreen\")\n      .style(\"opacity\", 0)\n      .transition()\n      .duration(1000)\n      .style(\"opacity\", 1)\n\n    this.foodOnBoard = true;\n  }\n\n  moveSnake(index, cord) {\n    d3.select('#segment' + index)\n      .attr(\"x\", cord[0])\n      .attr(\"y\", cord[1]);\n\n    if (+index !== this.snakeBody.length-1) {\n      let nextIdx = index + 1;\n      let oldCord = this.snakeBody[index];\n      this.moveSnake(nextIdx, oldCord)\n    }\n    this.snakeBody[index] = [cord[0], cord[1]];\n  }\n\n  gameLost() {\n    clearTimeout(this.gameTicker);\n    console.log('Game over.')\n    if(!this.playing) { return; }\n    this.playing = false;\n\n    // remove old stuff and show game over\n    d3.select('#food').transition()\n      .duration(1000)\n      .style(\"opacity\", 0)\n      .remove();\n\n    d3.selectAll(\".snake\").transition()\n      .duration(1000)\n      .style(\"opacity\", 0)\n      .remove();\n\n    d3.select('#bomb-text').remove();\n\n    d3.select('#bomb')\n      .transition()\n      .duration(1000)\n      .style(\"opacity\", 0)\n      .remove();\n\n    d3.select('#end-text').remove();\n      \n    d3.select('#game-space')\n      .append('h3')\n      .text('GAME OVER')\n      .attr('id', 'end-text')\n      .style(\"opacity\", 0)\n      .transition()\n      .duration(1000)\n      .style(\"opacity\", 1)\n\n    d3.select('#start-game')\n      .style(\"display\", \"block\")\n      \n  }\n\n  gameTick() {\n    this.count++;\n    if(this.snakeDirection === 'ArrowLeft') {\n      this.headCord[0] = this.headCord[0] - this.segmentDim;\n    }else if(this.snakeDirection === 'ArrowUp') {\n      this.headCord[1] = this.headCord[1] - this.segmentDim;\n    }else if(this.snakeDirection === 'ArrowRight') {\n      this.headCord[0] = this.headCord[0] + this.segmentDim;\n    }else if(this.snakeDirection === 'ArrowDown') {\n      this.headCord[1] = this.headCord[1] + this.segmentDim;\n    }\n    //headCord = [0,0]\n    this.snakeTail = [this.snakeBody[this.snakeBody.length-1][0], this.snakeBody[this.snakeBody.length-1][1]];\n\n    this.moveSnake(0, this.headCord);\n\n    if (this.foodCord.length > 0) {\n      if(this.foodCord[0] === this.headCord[0] && this.foodCord[1] === this.headCord[1]) {\n        console.warn('FOOD EATEN!!!')\n        this.score++;\n        if (this.speed > 100) {\n          this.speed = this.speed-10;\n        }\n\n        d3.select(\"#score-count\")\n          .text(this.score)\n\n        d3.select('#food').remove();\n        this.foodOnBoard = false;\n\n        this.snakeBody.push(this.snakeTail)\n\n        d3.select('#board').append('rect')\n          .attr(\"class\", \"snake\")\n          .attr(\"id\", \"segment\" + (this.snakeBody.length-1))\n          .attr(\"width\", this.segmentDim)\n          .attr(\"height\", this.segmentDim)\n          .attr(\"x\", this.snakeTail[0])\n          .attr(\"y\", this.snakeTail[1])\n          .attr(\"ry\", this.segmentRadius)\n          .attr(\"rx\", this.segmentRadius)\n          .attr(\"fill\", \"purple\");\n      }\n    }\n\n    if(this.count%5 === 0 && !this.foodOnBoard) {\n      this.spawnFood();\n    }\n\n    // put bomb stuff in seperate function\n    if(this.snakeBombs === undefined) {\n      this.snakeBombs = new SnakeBombs(this);\n    }\n\n    // bomb tick\n    if (this.snakeBombs.liveBomb) {\n      //console.log('This bomb is ticking...', this.snakeBombs.bombCount)\n      // count down in seconds\n      let slowCount = Math.round(1000/this.speed);\n      if (+this.snakeBombs.bombCount > 0 && this.count%slowCount === 1) {\n        this.snakeBombs.bombCount = this.snakeBombs.bombCount - 1;\n        d3.select('#bomb-text')\n          .text(this.snakeBombs.bombCount)\n      } else if (this.snakeBombs.bombCount <= 0){\n        // boom\n        console.log(\"Boom!\")\n        this.snakeBombs.bombGoesBoom();\n      }\n    }\n\n    // spawn bomb\n    if(this.score > 0 && this.count%10 === 0 && !this.snakeBombs.liveBomb) {\n      this.snakeBombs.spawnBomb();\n    }\n\n    // losing conditions\n    if(this.headCord[0] >= this.boardWidth || this.headCord[0] < 0 // off the sides \n      || this.headCord[1] < 0 || this.headCord[1] >= this.boardHeight) { // off the top or bottom\n      console.log('Snakes out of the box!')\n      this.gameLost();\n      return\n    }\n    for (let segment of this.snakeBody) {\n      if (this.snakeBody.indexOf(segment) === 0) {\n        continue\n      }\n      if(this.headCord[0] === segment[0] && this.headCord[1] === segment[1]) {\n        console.log('You bit your own tail...')\n        this.gameLost()\n        return\n      }\n    }\n\n    let that = this;\n    this.gameTicker = setTimeout(function() {\n      that.gameTick()\n    }, that.speed);\n  }\n\n}\n\nclass SnakeBombs {\n  constructor(snakeGame) {\n    this.snakeGame = snakeGame;\n\n    this.bombCord = [];\n    this.liveBomb = false;\n    this.bombCount = 0;\n    this.explosionRadius = 2;\n  }\n\n  spawnBomb() {\n    this.bombCord = this.snakeGame.randomBoardCord();\n    this.bombCount = 5;\n    d3.select('#board').append('rect')\n      .attr(\"id\", \"bomb\")\n      .attr(\"width\", this.snakeGame.segmentDim)\n      .attr(\"height\", this.snakeGame.segmentDim)\n      .attr(\"x\", this.bombCord[0])\n      .attr(\"y\", this.bombCord[1])\n      .attr(\"ry\", this.snakeGame.segmentRadius)\n      .attr(\"rx\", this.snakeGame.segmentRadius)\n      .attr(\"fill\", \"orange\")\n      .style(\"opacity\", 0)\n      .attr(\"stroke\", \"red\")\n      .transition()\n      .duration(1000)\n      .style(\"opacity\", 1)\n\n    d3.select('#board').append('text')\n      .attr('id', 'bomb-text')\n      .text(this.bombCount)\n      .style('fill', 'black')\n      .style('font-size', '65%')\n      .attr(\"transform\", \"translate(\"+(this.bombCord[0]+this.snakeGame.segmentDim/4)+\",\"+(this.bombCord[1]+this.snakeGame.segmentDim-1)+\")\");\n\n    this.liveBomb = true;\n  }\n\n  bombGoesBoom () {\n    \n    let colorScale = d3.scaleLinear()\n      .domain([0, this.explosionRadius])\n      .range(['red', 'yellow']);\n\n    let explosionArea = [];\n    for(let i = 1; i <= this.explosionRadius; i++) {\n      let start = this.bombCord;\n      for(let xDim = -i; xDim <= i; xDim++) {\n        for(let yDim = -i; yDim <= i; yDim++) {\n          let newX = start[0] + (xDim*this.snakeGame.segmentDim)\n          let newY = start[1] + (yDim*this.snakeGame.segmentDim)\n          let newCord = [newX, newY];\n          if(!explosionArea.includes(newCord)) {\n            explosionArea.push(newCord)\n          }\n        }\n      }\n    }\n    for(let block of explosionArea) {\n      // distance in block units\n      let distance = distanceBetweenPoints(this.bombCord, block)/this.snakeGame.segmentDim\n\n      d3.select('#board').append('rect')\n        .attr(\"class\", \"boom\")\n        .attr(\"width\", this.snakeGame.segmentDim)\n        .attr(\"height\", this.snakeGame.segmentDim)\n        .attr(\"x\", block[0])\n        .attr(\"y\", block[1])\n        .attr(\"ry\", this.snakeGame.segmentRadius)\n        .attr(\"rx\", this.snakeGame.segmentRadius)\n        .attr(\"fill\", colorScale(distance))\n        .style(\"opacity\", 1)\n        .attr(\"stroke\", \"red\")\n        .transition()\n        .duration(1500)\n        .style(\"opacity\", 0)\n        .attr(\"fill\", \"blue\")\n        .attr(\"width\", 1)\n        .attr(\"height\", 1)\n        .remove();\n    }\n\n    d3.select('#bomb-text').remove();\n    d3.select('#bomb')\n      .transition()\n      .duration(1500)\n      .style(\"opacity\", 0)\n      .remove();\n\n    this.bombCount = 0;\n    this.liveBomb = false;\n\n    this.isHeadInExplosion()\n  }\n\n  isHeadInExplosion() {\n    let bombR = this.explosionRadius;\n    let segDim = this.snakeGame.segmentDim;\n    let explosionXRange = [this.bombCord[0]-segDim*bombR, this.bombCord[0]+segDim*bombR];\n    let explosionYRange = [this.bombCord[1]-segDim*bombR, this.bombCord[1]+segDim*bombR];\n    let detectX = this.snakeGame.headCord[0] >= explosionXRange[0] && this.snakeGame.headCord[0] <= explosionXRange[1];\n    let detectY = this.snakeGame.headCord[1] >= explosionYRange[0] && this.snakeGame.headCord[1] <= explosionYRange[1];\n    if (detectX && detectY) {\n      console.log(\"Ouch, killed by a bomb...\")\n      this.snakeGame.gameLost();\n    }\n  }\n  \n}\n\nfunction distanceBetweenPoints (pointA, pointB) {\n  let x0 = pointA[0];\n  let x1 = pointB[0];\n  let y0 = pointA[1];\n  let y1 = pointB[1];\n  let x = Math.pow((x1-x0), 2);\n  let y = Math.pow((y1-y0), 2)\n  let distance = Math.pow((x + y), 0.5);\n\n  return distance;\n}\n\nlet snakeGame = new SnakeGame();\nexport function startSnakeGame() {\n  console.log('startSnakeGame: Start game!!')\n  snakeGame.initGame()\n}\n"]},"metadata":{},"sourceType":"module"}